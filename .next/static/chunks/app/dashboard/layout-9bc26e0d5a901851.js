(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7663],{49320:function(e,t,s){Promise.resolve().then(s.bind(s,38564))},38564:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(57437),r=s(46281),l=s(99376),n=s(2265),o=s(27648);function c(e){let{children:t}=e,{user:s,tenant:c,logout:i,loading:u}=(0,r.a)(),d=(0,l.useRouter)();return((0,n.useEffect)(()=>{u||s||d.push("/login")},[s,u,d]),u)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-lg text-slate-600",children:"Loading..."})}):s&&c?(0,a.jsxs)("div",{className:"min-h-screen bg-slate-100",children:[(0,a.jsx)("header",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(o.default,{href:"/dashboard",className:"text-xl font-bold text-slate-900",children:"Website Builder"}),(0,a.jsx)("span",{className:"text-sm text-slate-500",children:c.name})]}),(0,a.jsxs)("nav",{className:"flex items-center space-x-6",children:[(0,a.jsx)(o.default,{href:"/dashboard",className:"text-slate-700 hover:text-slate-900 font-medium",children:"Dashboard"}),(0,a.jsx)(o.default,{href:"/dashboard/websites",className:"text-slate-700 hover:text-slate-900 font-medium",children:"Websites"}),(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsxs)("button",{className:"flex items-center text-slate-700 hover:text-slate-900",children:[s.email,(0,a.jsx)("svg",{className:"ml-1 h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 hidden group-hover:block",children:[(0,a.jsx)("a",{href:"#",className:"block px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"Settings"}),(0,a.jsx)("button",{onClick:i,className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"Sign out"})]})]})]})]})})}),(0,a.jsx)("main",{className:"px-6 py-8",children:t})]}):null}},46281:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},a:function(){return c}});var a=s(57437),r=s(2265),l=s(29116);let n=(0,r.createContext)(void 0);function o(e){let{children:t}=e,[s,o]=(0,r.useState)(null),[c,i]=(0,r.useState)(null),[u,d]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=localStorage.getItem("accessToken"),t=localStorage.getItem("user"),s=localStorage.getItem("tenant");e&&t&&s&&(o(JSON.parse(t)),i(JSON.parse(s))),d(!1)},[]);let h=async(e,t)=>{try{let{user:s,tenant:a,tokens:r}=(await l.Z.post("/api/auth/login",{email:e,password:t})).data;localStorage.setItem("accessToken",r.accessToken),localStorage.setItem("refreshToken",r.refreshToken),localStorage.setItem("user",JSON.stringify(s)),localStorage.setItem("tenant",JSON.stringify(a)),o(s),i(a)}catch(e){var s,a;throw Error((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.error)||"Login failed")}},m=async(e,t,s,a)=>{try{let{user:r,tenant:n,tokens:c}=(await l.Z.post("/api/auth/register",{tenantName:e,tenantSlug:t,email:s,password:a})).data;localStorage.setItem("accessToken",c.accessToken),localStorage.setItem("refreshToken",c.refreshToken),localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("tenant",JSON.stringify(n)),o(r),i(n)}catch(e){var r,n;throw Error((null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.error)||"Registration failed")}};return(0,a.jsx)(n.Provider,{value:{user:s,tenant:c,login:h,register:m,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("tenant"),o(null),i(null)},loading:u},children:t})}function c(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},29116:function(e,t,s){"use strict";var a=s(83464);let r=s(40257).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",l=a.Z.create({baseURL:r,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{{let t=localStorage.getItem("accessToken");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),t.Z=l},99376:function(e,t,s){"use strict";var a=s(35475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[7648,3464,2971,2117,1744],function(){return e(e.s=49320)}),_N_E=e.O()}]);