(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2626],{78220:function(e,t,s){Promise.resolve().then(s.bind(s,66374))},66374:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var r=s(57437),a=s(2265),o=s(99376),n=s(46281),l=s(27648);function u(){let[e,t]=(0,a.useState)(""),[s,u]=(0,a.useState)(""),[c,i]=(0,a.useState)(""),[d,m]=(0,a.useState)(!1),{login:f}=(0,n.a)(),h=(0,o.useRouter)(),g=async t=>{t.preventDefault(),i(""),m(!0);try{await f(e,s),h.push("/dashboard")}catch(e){i(e.message)}finally{m(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-100",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow p-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-center mb-8",children:"Sign In"}),(0,r.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700",children:"Email"}),(0,r.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"mt-1 block w-full rounded-md border border-slate-300 px-3 py-2 focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700",children:"Password"}),(0,r.jsx)("input",{id:"password",type:"password",value:s,onChange:e=>u(e.target.value),required:!0,className:"mt-1 block w-full rounded-md border border-slate-300 px-3 py-2 focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"})]}),c&&(0,r.jsx)("div",{className:"text-red-600 text-sm text-center",children:c}),(0,r.jsx)("button",{type:"submit",disabled:d,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-slate-900 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 disabled:opacity-50",children:d?"Signing in...":"Sign In"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)("p",{className:"text-sm text-slate-600",children:["Don't have an account?"," ",(0,r.jsx)(l.default,{href:"/register",className:"font-medium text-slate-900 hover:text-slate-700",children:"Sign up"})]})})]})})}},46281:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return l},a:function(){return u}});var r=s(57437),a=s(2265),o=s(29116);let n=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[s,l]=(0,a.useState)(null),[u,c]=(0,a.useState)(null),[i,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=localStorage.getItem("accessToken"),t=localStorage.getItem("user"),s=localStorage.getItem("tenant");e&&t&&s&&(l(JSON.parse(t)),c(JSON.parse(s))),d(!1)},[]);let m=async(e,t)=>{try{let{user:s,tenant:r,tokens:a}=(await o.Z.post("/api/auth/login",{email:e,password:t})).data;localStorage.setItem("accessToken",a.accessToken),localStorage.setItem("refreshToken",a.refreshToken),localStorage.setItem("user",JSON.stringify(s)),localStorage.setItem("tenant",JSON.stringify(r)),l(s),c(r)}catch(e){var s,r;throw Error((null===(r=e.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.error)||"Login failed")}},f=async(e,t,s,r)=>{try{let{user:a,tenant:n,tokens:u}=(await o.Z.post("/api/auth/register",{tenantName:e,tenantSlug:t,email:s,password:r})).data;localStorage.setItem("accessToken",u.accessToken),localStorage.setItem("refreshToken",u.refreshToken),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("tenant",JSON.stringify(n)),l(a),c(n)}catch(e){var a,n;throw Error((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.error)||"Registration failed")}};return(0,r.jsx)(n.Provider,{value:{user:s,tenant:u,login:m,register:f,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("tenant"),l(null),c(null)},loading:i},children:t})}function u(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},29116:function(e,t,s){"use strict";var r=s(83464);let a=s(40257).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",o=r.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{{let t=localStorage.getItem("accessToken");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),t.Z=o},99376:function(e,t,s){"use strict";var r=s(35475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[7648,3464,2971,2117,1744],function(){return e(e.s=78220)}),_N_E=e.O()}]);